"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[8844],{78844:function(e,a,t){t.r(a),t.d(a,{default:function(){return j}});var n=t(4942),r=t(1413),o=t(29439),i=t(72791),c=t(57689),s=t(84951),d=t(18491),l=t(24021),m=t(22976),u=t(77710),g=t(21830),p=t.n(g),h=(t(72426),t(63263)),f=t(9085),y=t(80184),x={programName:"",selectAwards:"",awardsOptions:[],backgroundImage:"",bodyCopy:"",stname:"Student name",imageName:"",loader:!1},j=function(){var e=(0,i.useState)(x),a=(0,o.Z)(e,2),t=a[0],g=a[1],j=(0,i.useState)(""),b=(0,o.Z)(j,2),v=b[0],N=b[1],Z=(t.programName,t.selectAwards),C=t.awardsOptions,w=t.backgroundImage,_=t.bodyCopy,k=t.stname,A=t.imageName,P=t.loader,I=(0,c.s0)(),B=(0,c.UO)(),S=function(e,a){g((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,n.Z)({},e,a.target.value))}))};return(0,i.useEffect)((function(){"new"!==B.id&&u.Z.get("/certificate/".concat(B.id)).then((function(e){g((function(a){return(0,r.Z)((0,r.Z)({},a),{},{programName:e.data.name,selectAwards:{value:e.data.level.id,label:e.data.level.name},imageName:e.data.backgroundPhoto,bodyCopy:e.data.templateBody})})),""!==e.data.backgroundPhoto&&null!==e.data.backgroundPhoto&&(h.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),u.Z.get("".concat("http://3.136.240.37:9090/api/v1/","auth/certificate/image/").concat(e.data.backgroundPhoto),{responseType:"arraybuffer"}).then((function(e){if(200===e.status){var a=btoa(new Uint8Array(e.data).reduce((function(e,a){return e+String.fromCharCode(a)}),""));N("data:".concat(e.headers["content-type"].toLowerCase(),";base64,").concat(a)),console.log("Certificate Image Data:",e)}else console.error("Failed to fetch image:",e.statusText)})).catch((function(e){console.log("error loading image"),p().fire(e.response.data.message,"Please try again later")})))})).catch((function(e){p().fire(e.response.data.message,"Please try again ")})),u.Z.get("level").then((function(e){var a=[];e.data.map((function(e,t){a.push({value:e.id,label:e.name})})),g((function(e){return(0,r.Z)((0,r.Z)({},e),{},{awardsOptions:a})}))})).catch((function(e){p().fire(e.response.data.message,"Please try again ")}))}),[]),(0,y.jsxs)(y.Fragment,{children:[" ",P?(0,y.jsx)(s.$j,{className:"loaderr",color:"primary",children:"Loading..."}):null,(0,y.jsx)(f.Ix,{}),(0,y.jsx)(s.Zb,{className:"cardm",children:(0,y.jsx)(s.eW,{className:"cardbg",children:(0,y.jsx)(d.J9,{enableReinitialize:!0,initialValues:t,validationSchema:function(){return l.object().shape({programName:l.string().required("Program Name is Required"),selectAwards:l.object().required("Awards is Required"),bodyCopy:l.string().required("Body is Required").test("Template Body","Template body length is too long",(function(e){return e.length<=255}))})},onSubmit:function(e){if(""===A)p().fire("Please Select Background Image");else if("new"!==B.id){var a={name:e.programName,backgroundPhoto:e.imageName,templateBody:e.bodyCopy};h.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),h.Z.put("".concat("http://3.136.240.37:9090/api/v1/","api/level/").concat(Z.value,"/certificate/").concat(B.id),a).then((function(e){f.Am.info("Updated successfully",{theme:"colored"}),setTimeout((function(){I("/certifications")}),1e3)})).catch((function(e){p().fire(e.response.data.message,"Please try again later")}))}else{g((function(e){return(0,r.Z)((0,r.Z)({},e),{},{loader:!0})}));var t={name:e.programName,backgroundPhoto:e.imageName,templateBody:e.bodyCopy};h.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),h.Z.post("".concat("http://3.136.240.37:9090/api/v1/api","/level/").concat(Z.value,"/certificate"),t).then((function(e){f.Am.success("Registered successfully",{theme:"colored"}),g((function(e){return(0,r.Z)((0,r.Z)({},e),{},{loader:!1})})),setTimeout((function(){I("/certifications")}),1e3)})).catch((function(e){g((function(e){return(0,r.Z)((0,r.Z)({},e),{},{loader:!1})})),p().fire(e.response.data.message,"Please try again ")}))}},children:function(e){var a=e.values,t=e.setFieldValue,o=e.handleChange,i=e.handleSubmit;e.handleBlur,e.errors,e.touched;return(0,y.jsx)(d.l0,{onSubmit:i,children:(0,y.jsxs)(s.Zb,{className:"cardbgw",children:[(0,y.jsxs)(s.Ol,{children:[" ",(0,y.jsx)("h5",{children:(0,y.jsx)("strong",{children:"Certification"})})," "]}),(0,y.jsxs)(s.eW,{children:[(0,y.jsx)(s.X2,{children:(0,y.jsxs)(s.JX,{md:12,children:[(0,y.jsx)(s.__,{for:"programName",children:" Program Name "}),(0,y.jsx)(s.II,{name:"programName",type:"text",value:a.programName,onChangeCapture:o,onChange:function(e){return S("programName",e)}}),(0,y.jsx)(d.Bc,{name:"programName",component:"div",className:"errmsg"})]})}),(0,y.jsxs)(s.X2,{children:[(0,y.jsxs)(s.JX,{md:5,children:[(0,y.jsx)(s.__,{for:"selectName",children:"Awards"}),(0,y.jsx)(m.ZP,{name:"selectAwards",value:Z,onChange:function(e){t("selectAwards",e),function(e,a){g((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,n.Z)({},e,a))}))}("selectAwards",e)},options:C}),(0,y.jsx)(d.Bc,{name:"selectAwards",component:"div",className:"errmsg"})]}),(0,y.jsxs)(s.JX,{md:7,children:[(0,y.jsx)(s.__,{for:"programName",children:" BackGround Image "}),(0,y.jsx)(s.II,{name:"backgroundImage",type:"file",accept:".jpg, .jpeg, .png",value:w.name,onChange:function(e){return function(e){var a=URL.createObjectURL(e.target.files[0]);N(a);var t=new FormData;t.append("image",e.target.files[0]),h.Z.defaults.headers.common.Authorization="Bearer "+localStorage.getItem("token"),h.Z.post("".concat("http://3.136.240.37:9090/api/v1/api","/certificate/image/upload"),t).then((function(e){g((function(a){return(0,r.Z)((0,r.Z)({},a),{},{imageName:e.data.imageName})}))})).catch((function(e){p().fire(e.response.data.message,"Please try again ")}))}(e)},required:!B.id})]})]}),(0,y.jsx)(s.X2,{children:(0,y.jsxs)(s.JX,{md:12,children:[(0,y.jsx)(s.__,{for:"bodyCopy",children:"Body Copy "}),(0,y.jsx)(s.II,{name:"bodyCopy",type:"textarea",value:a.bodyCopy,onChangeCapture:o,onChange:function(e){return S("bodyCopy",e)},placeholder:"content display in certification...",rows:"2 "}),(0,y.jsx)(d.Bc,{name:"bodyCopy",component:"div",className:"errmsg"})]})}),(0,y.jsx)(s.X2,{children:(0,y.jsxs)(s.JX,{md:4,children:[(0,y.jsx)(s.__,{for:"preview",children:"Preview "}),(0,y.jsx)("div",{className:"App",children:(0,y.jsx)("div",{id:"downloadWrapper",children:(0,y.jsxs)("div",{id:"certificateWrapper",children:[(0,y.jsx)("p",{className:"name",children:k}),(0,y.jsx)("img",{src:""==v?"https://i.imgur.com/Toz3PUWh.png":v,alt:"Certificate"}),(0,y.jsx)("p",{className:"bodyCopy",children:_})]})})})]})})]}),(0,y.jsxs)(s.iR,{className:"centerTextalign",children:[(0,y.jsx)(s.zx,{type:"button",color:"secondary",className:"btnbg",size:"sm",onClick:function(){I("/certifications")},children:"Cancel"}),(0,y.jsx)(s.zx,{type:"submit",color:"primary",size:"sm",children:"Save"})]})]})})}})})})]})}}}]);
//# sourceMappingURL=8844.7759a2ac.chunk.js.map